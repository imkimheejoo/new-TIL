## 테스트

### 소형테스트 (= 단위 테스트)

- 단일서버, 단일 프로세스, 단일 스레드에서 동작하는 테스트
- 디스크 I/O 를 사용해선 안됨
- blocking call 허용 안됨 (ex. network call)
- 테스트 결과가 항상 고정적

### 중형테스트

- 단일서버, 멀티 프로세스, 멀티스레드에서 동작하는 테스트
    - h2같은 테스트용 DB 사용 가능
    - 테스트 결과가 외부모듈에 따라 다르게 나올 수 있음

### 대형테스트

- 멀티서버 (ex. end to end test)

## 개념

### SUT

> 테스트 할 대상

### BDD (Behaviour driven development) -> given / when / then

> 메소드 위주의 테스트 보다 시나리오(행동)에 기반한 테스트 방식

- ex) 골드등급이 주문을 하면 주문금액에 10%를 할인해준다.

### 상호작용 테스트 (interaction test)

> 메소드가 실제로 호출 됐는지 확인하는 테스트

- ex) verify(exactly = 1)
    - 하지만 이건 내부로직을 테스트하는 테스트라 추천은 하지 않음 (시나리오가 아닌 구현로직을 테스트하는 느낌?)
    - 따라서 이것보단 상태를 검증하는 테스트를 만드는게 좋다.

### Stub

> 미리 준비된 값을 출력하는 객체

- 주로 외부 연동하는 컴포넌트들에 많이 사용하는 객체

```kotlin
// 예시
fun stub() = User(name = "heejoo", age = 28)    // 미리 준비된 user 객체
```

### Mock 프레임워크를 주의해야하는 이유

> 테스트 코드를 짜는게 목적이 되어 유연한 설계를 얻을 기회를 빼앗아 감 -> mock 구현하다 시간 다가서 지침 (배보다 배꼽이 더 큰 경우)

### 테스트 조언

- 행위에 대한 책임을 테스트하라!
- private method는 테스트 해야하는가? - NO
    - private method를 테스트 하고 싶은 마음이 든다면 그건 그 로직이 책임을 갖고있다는 뜻이다. -> 클래스로 분리해서 책임을 할당
